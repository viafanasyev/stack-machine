LOOP:
IN
DUP
PUSH 0
JMPE LOOP_END
CALL FIBONACCI
OUT
JMP LOOP
LOOP_END:
HLT

FIBONACCI:

DUP
PUSH 1
JMPE FIBONACCI_EXIT_1

DUP
PUSH 2
JMPE FIBONACCI_EXIT_2

CALL DEC
DUP
CALL DEC
CALL FIBONACCI
CALL SWAP_TOP
CALL FIBONACCI
ADD
RET

FIBONACCI_EXIT_2:
CALL DEC
FIBONACCI_EXIT_1:
RET

DEC:
PUSH 1
SUB
RET

SWAP_TOP:
POP AX
POP BX
PUSH AX
PUSH BX
RET
